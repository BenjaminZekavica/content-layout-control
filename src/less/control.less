/**
 * Content Layout Control for the WordPress Customizer
 *
 * Styles for the base control and slide-out selection list. Components
 * enqueue their own styles.
 *
 * @since 0.1
 */
@import "vars-control";
@import "utils";

// Selection list
#clc-secondary-panel {
	position: absolute;
	top: 0;
	bottom: 0;
	left: -301px;
	width: 300px;
	overflow: hidden;
	background: @lift;
	transition: left .18s;
	z-index: 1;
}

.clc-secondary-open {

	#customize-preview {
		opacity: 0.4;
	}

	.wp-full-overlay-main {
		left: 300px;
	}

	#clc-secondary-panel {
		left: 0;
	}
}

#clc-secondary-panel {

	.clc-header {
		padding: @base;
		height: 25px;
		background: #eee;
		border-bottom: 1px solid #ddd;
		text-align: right;
	}

	.clc-secondary-content {
		position: absolute;
		top: 46px;
		bottom: 0;
		margin: 0;
		width: 100%;
		overflow-y: scroll;
		overflow-x: hidden;

		> ul {
			margin: 0;
		}
	}
}

// Component selection list
.clc-component-list {

	> ul {
		margin: 0;

		> li {
			margin-bottom: 0;
		}
	}

	.component {
		display: block;
		position: relative;
		padding: 20px 15px 20px 60px;
		border-bottom: @border;
		color: @text;
		text-decoration: none;

		&:hover,
		&:focus {
			background: @shade;
		}

		&:before {
			content: "\f333";
			position: absolute;
			top: 20px;
			left: 20px;
			width: 20px;
			height: 20px;
			font: normal 20px/1 'dashicons';
			text-align: center;
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
		}
	}

	h4 {
		margin: 0;
		font-size: 14px;
		line-height: 20px;
	}

	.description {
		font-size: 12px;
		color: #777;
	}
}

// Added components
// Mimics the widget styles from core
.clc-content-list {

	> li {
		margin-bottom: @base;
		background: @lift;
		border: @border;
		-webkit-box-shadow: 0 1px 1px rgba(0,0,0,0.04);
		box-shadow: 0 1px 1px rgba(0,0,0,0.04);

		.header {
			position: relative;
			background: @shade;
			cursor: move;

			.name {
				margin: 0;
				padding: @base + @half;
				color: #23282d;
				overflow: hidden;
				white-space: nowrap;
				text-overflow: ellipsis;

				.title {
					padding-left: 0.25em;
					color: #666;
				}
			}
		}

		.clc-toggle-component-form {
			display: block;
			position: absolute;
			top: 0;
			right: 0;
			width: 48px;
			height: 48px;
			line-height: 48px;
			overflow: hidden;


			&:before {
				// Copies core's widget caret style up to empty line
				right: 0;
				content: '\f140';
				font: normal 20px/1 'dashicons';
				speak: none;
				display: block;
				text-align: center;
				position: relative;
				-webkit-font-smoothing: antialiased;
				-moz-osx-font-smoothing: grayscale;

				line-height: 48px;
				background: @shade;
			}
		}

		.control {
			padding: @base;
		}

		.setting,
		label {
			display: block;
			margin-bottom: @double;

			&:last-child {
				margin-bottom: 0 ;
			}
		}

		textarea {
			width: 98%;
			height: 10em;
		}

		.footer {
			padding: @base;
			border-top: @border;
			text-align: right;

			.delete {
				color: #f00;
			}
		}

		// Closed
		.control,
		.footer {
			display: none;
		}

		// Open
		&.is-open {

			.header {
				border-bottom: @border;
			}

			.clc-toggle-component-form:before {
				content: '\f142';
			}

			.control,
			.footer {
				display: block;
			}
		}
	}

	// Placeholder displayed during drag and drop
	.clc-content-list-placeholder {
		display: block;
		width: 100%;
		height: 48px;
		border: 1px dashed #bbb;
		background: #fafafa;
	}
}

// Bottom of added component list
.customize-control-content_layout {

	.buttons {
		text-align: right;
	}

	.add-component {

		&:before {
			content: '\f132';
			display: inline-block;
			font: normal 20px/1 'dashicons';
			speak: none;
			position: relative;
			vertical-align: middle;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
			transition: transform 0.2s;
		}
	}
}

.clc-component-list-open .add-component:before {
	-webkit-transform: rotate(45deg);
	-ms-transform: rotate(45deg);
	transform: rotate(45deg);
}

// Button rows within components
.clc-content-list .buttons {
	text-align: left;

	button {
		outline: 0; // Rely on focus styles from core
	}
}

// Link panel controls
.link-panel-control {

	.add-link {

		&:before {
			content: '\f103';
			display: inline-block;
			font: normal 20px/1 'dashicons';
			speak: none;
			position: relative;
			vertical-align: middle;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
			transition: transform 0.2s;
		}
	}

	.buttons {
		margin-top: @base;
	}
}

.clc-links-panel-open  .link-panel-control .add-link:before {
	content: '\f132';
	-webkit-transform: rotate(45deg);
	-ms-transform: rotate(45deg);
	transform: rotate(45deg);
}

.link-panel-control-links {

	> li {
		position: relative;
		margin-bottom: @base;
	}

	.link {
		display: block;
		padding: @half (@double * 2) @half @base;
		background: @shade;
		box-shadow: 0 0 2px rgba(0,0,0,0.2);
		white-space: nowrap;
		overflow-x: hidden;
		text-overflow: ellipsis;

		&:hover,
		&:focus {
			box-shadow: 0 0 2px rgba(0,0,0,0.6);

			&:after {
				@content_block_links_box: @double + @base - 2;
				content: '\f504';
				display: block;
				position: absolute;
				top: 0;
				right: @content_block_links_box;
				width: @content_block_links_box;
				height: @content_block_links_box;
				background: @shade;
				font-family: 'dashicons';
				line-height: @double + @base;
				text-align: center;
				speak: none;
				vertical-align: middle;
				color: #777;
			}
		}
	}

	.remove-link {
		position: absolute;
		top: 0;
		right: 0;
		width: @double + @base;
		height: @double + @base;
		border-left: @border;
		line-height: @double;
		text-align: center;
		color: red;
		opacity: 0.5;
		overflow: hidden;

		&:before {
			content: '\f335';
			display: block;
			width: @double + @base;
			height: @double + @base;
			font: normal 20px/1 'dashicons';
			line-height: @double + @base;
			speak: none;
			position: relative;
			vertical-align: middle;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
		}

		&:hover {
			opacity: 1;
			border-left-color: red;
		}
	}
}

// Links panel
.clc-link-panel {

	.customize-control-title {
		margin-bottom: 0;
	}

	&.search-visible {

		.clc-link-panel-search {
			left: 0;
		}

		.clc-link-panel-form {
			left: -100%;
		}
	}
}

.clc-link-panel-form {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	padding: @base;
	box-sizing: border-box;
	transition: 0.3s left;

	label {
		display: block;
		margin-bottom: @base;
	}

	input {
		width: 100%;
	}

	.button-link {
		padding-left: 0.5em;
		line-height: 28px;
	}
}

.clc-link-panel-search {
	position: absolute;
	padding: @base;
	top: 0;
	left: 100%;
	width: 100%;
	transition: 0.3s left;
	box-sizing: border-box;

	input {
		width: 80%;
	}

	.clc-spinner {
		display: block;
		position: absolute;
		bottom: 1em;
		right: 1em;
		width: 16px;
		height: 16px;
		.halfcircle( 2px, @text );
		.animation( clc_spin 1s linear infinite );
		visibility: hidden;
		opacity: 0.5;
	}

	.back-to-search-form {
		display: inline-block;
		padding: 1em 0;
		text-decoration: none;
	}
}

.clc-link-panel.fetching .clc-spinner {
	visibility: visible;
}

.clc-link-panel-list {
	margin: 0 -@base;
	border-top: @border;

	li {
		margin: 0;
	}

	a {
		display: block;
		padding: @base;
		border-bottom: @border;
		text-decoration: none;
		color: @text;

		&:hover,
		&:focus {
			background: @shade;
		}
	}

	h4 {
		margin: 0;
		font-size: 14px;
		line-height: 20px;
		overflow-x: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
	}

	.post-type {
		font-size: 12px;
		color: #777;
	}
}
